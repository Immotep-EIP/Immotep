datasource db {
    provider = "postgres"
    url      = env("DATABASE_URL")
}

generator db {
    provider = "go run github.com/steebchen/prisma-client-go"
}

enum role {
    owner
    tenant
}

model user {
    id          String   @id @default(cuid())
    email       String   @unique @db.VarChar(255)
    password    String
    firstname   String
    lastname    String
    role        role
    created_at  DateTime @default(now())
    updated_at  DateTime @updatedAt

    ownedProperties   property[]
    rentedProperties  contract[]
}

model contract {
    tenant      user      @relation(fields: [tenantId], references: [id])
    tenantId    String
    property    property  @relation(fields: [propertyId], references: [id])
    propertyId  String

    active      Boolean   @default(true)
    unlimited   Boolean
    startDate   DateTime
    endDate     DateTime?
    created_at  DateTime  @default(now())

    @@id([tenantId, propertyId])
}

model property {
    id          String   @id @default(cuid())
    name        String
    address     String
    city        String
    postalCode  String
    country     String
    created_at  DateTime @default(now())

    owner       user     @relation(fields: [ownerId], references: [id])
    ownerId     String

    contracts   contract[]
    pendingContracts  pendingContract[]
}

model pendingContract {
    id           String   @id @default(cuid())
    tenantEmail  String   @unique @db.VarChar(255)

    unlimited   Boolean
    startDate   DateTime
    endDate     DateTime?
    created_at  DateTime  @default(now())

    property     property @relation(fields: [propertyId], references: [id])
    propertyId   String
}
